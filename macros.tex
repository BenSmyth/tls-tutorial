%%%
%%% Handshake protocol mesages
%%%

\newcommand{\TLSMessage}[1]{\texttt{#1}}

\newcommand{\ClientHello}{\TLSMessage{ClientHello}}
\newcommand{\ServerHello}{\TLSMessage{ServerHello}}
%\newcommand{\HelloRequest}{\TLSMessage{HelloRequest}}
\newcommand{\HelloRetryRequest}{\TLSMessage{HelloRetryRequest}}

\newcommand{\ChangeCipherSpec}{\TLSMessage{ChangeCipherSpec}}

\newcommand{\EncryptedExtensions}{\TLSMessage{EncryptedExtensions}}

\newcommand{\CertificateRequest}{\TLSMessage{CertificateRequest}}
\newcommand{\Certificate}{\TLSMessage{Certificate}}
\newcommand{\CertificateVerify}{\TLSMessage{CertificateVerify}}

\newcommand{\Finished}{\TLSMessage{Finished}}

\newcommand{\EndOfEarlyData}{\TLSMessage{EndOfEarlyData}}

\newcommand{\KeyUpdate}{\TLSMessage{KeyUpdate}}
\newcommand{\NewSessionTicket}{\TLSMessage{NewSessionTicket}}

%%%
%%% Record layer records
%%%

\newcommand{\TLSRecord}[1]{\texttt{#1}}

\newcommand{\TLSPlaintext}{\TLSRecord{TLSPlaintext}}
\newcommand{\TLSCiphertext}{\TLSRecord{TLSCiphertext}}

\newcommand{\TLSInnerPlaintext}{\TLSRecord{TLSInnerPlaintext}}

%%%
%%% Field types
%%%

\newcommand{\TLSType}[1]{\textsf{#1}}

\newcommand{\TLSProtocolVersion}{\TLSType{ProtocolVersion}}
\newcommand{\TLSRandom}{\TLSType{Random}}
\newcommand{\TLSCipherSuite}{\TLSType{CipherSuite}}
\newcommand{\TLSExtension}{\TLSType{Extension}}

%%%
%%% Fields
%%%

\newcommand{\TLSField}[1]{\texttt{#1}}

\newcommand{\TLSalgorithm}{\TLSField{algorithm}}
\newcommand{\TLSapplicationLayerProtocolNegotiation}{\TLSField{application\_layer\_protocol\_negotiation}}
\newcommand{\TLScertificateAuthorities}{\TLSField{certificate\_authorities}}
\newcommand{\TLScertificateRequestContext}{\TLSField{certificate\_request\_context}}
\newcommand{\TLScipherSuite}{\TLSField{cipher\_suite}}
\newcommand{\TLScipherSuites}{\TLSField{cipher\_suites}}
\newcommand{\TLScertificateList}{\TLSField{certificate\_list}}
\newcommand{\TLSclientCertificateType}{\TLSField{client\_certificate\_type}}
\newcommand{\TLScookie}{\TLSField{cookie}}
\newcommand{\TLSearlyData}{\TLSField{early\_data}}
\newcommand{\TLSencryptedRecord}{\TLSField{encrypted\_record}}
\newcommand{\TLSextensionData}{\TLSField{extension\_data}}
\newcommand{\TLSextensionType}{\TLSField{extension\_type}}
\newcommand{\TLSextensions}{\TLSField{extensions}}
\newcommand{\TLSfragment}{\TLSField{fragment}}
\newcommand{\TLSheartbeat}{\TLSField{heartbeat}}
\newcommand{\TLSkeyShare}{\TLSField{key\_share}}
\newcommand{\TLSlegacyCompressionMode}{\TLSField{legacy\_compression\_method}}
\newcommand{\TLSlegacyCompressionModes}{\TLSField{legacy\_compression\_methods}}
\newcommand{\TLSlegacyRecordVersion}{\TLSField{legacy\_record\_version}}
\newcommand{\TLSlegacySessionId}{\TLSField{legacy\_session\_id}}
\newcommand{\TLSlegacySessionIdEcho}{\TLSField{legacy\_session\_id\_echo}}
\newcommand{\TLSlegacyVersion}{\TLSField{legacy\_version}}
\newcommand{\TLSlength}{\TLSField{length}}
\newcommand{\TLSmaxFragmentLength}{\TLSField{max\_fragment\_length}}
\newcommand{\TLSoidFilters}{\TLSField{oid\_filters}}
\newcommand{\TLSopaqueType}{\TLSField{opaque\_type}}
\newcommand{\TLSpadding}{\TLSField{padding}}
\newcommand{\TLSpostHandshakeAuth}{\TLSField{post\_handshake\_auth}}
\newcommand{\TLSpskModes}{\TLSField{psk\_key\_exchange\_modes}}
\newcommand{\TLSpsk}{\TLSField{pre\_shared\_key}}
\newcommand{\TLSrandom}{\TLSField{random}}
\newcommand{\TLSrequestUpdate}{\TLSField{request\_update}}
\newcommand{\TLSserverCertificateType}{\TLSField{server\_certificate\_type}}
\newcommand{\TLSserverName}{\TLSField{server\_name}}
\newcommand{\TLSsignature}{\TLSField{signature}}
\newcommand{\TLSsignatureAlgorithms}{\TLSField{signature\_algorithms}}
\newcommand{\TLSsignatureAlgorithmsCert}{\TLSField{signature\_algorithms\_cert}}
\newcommand{\TLSsignedCertificateTimestamp}{\TLSField{signed\_certificate\_timestamp}}
\newcommand{\TLSstatusRequest}{\TLSField{status\_request}}
\newcommand{\TLSsupportedGroups}{\TLSField{supported\_groups}}
\newcommand{\TLSsupportedVersions}{\TLSField{supported\_versions}}
\newcommand{\TLSsupportedSignatureAlgorithms}{\TLSField{supported\_signature\_algorithms}}
\newcommand{\TLSticket}{\TLSField{ticket}}
\newcommand{\TLSticketAgeAdd}{\TLSField{ticket\_age\_add}}
\newcommand{\TLSticketLifetime}{\TLSField{ticket\_lifetime}}
\newcommand{\TLSticketNonce}{\TLSField{ticket\_nonce}}
\newcommand{\TLStype}{\TLSField{type}}
\newcommand{\TLSuseSrtp}{\TLSField{use\_srtp}}
\newcommand{\TLSverifyData}{\TLSField{verify\_data}}
\newcommand{\TLSzeros}{\TLSField{zeros}}


%%%
%%% Constants
%%%

\newcommand{\TLSConstant}[1]{\textsf{#1}}

\newcommand{\TLSapplicationData}{\TLSConstant{application\_data}}
\newcommand{\TLSalert}{\TLSConstant{alert}}
\newcommand{\TLSchangeCipherSpec}{\TLSConstant{change\_cipher\_spec}}
\newcommand{\TLShandshake}{\TLSConstant{handshake}}

\newcommand{\TLSPskKe}{\TLSConstant{psk\_ke}}
\newcommand{\TLSPskDheKe}{\TLSConstant{psk\_dhe\_ke}}

\newcommand{\TLSmessageHash}{\TLSConstant{message\_hash}}

%%%
%%% Values
%%%

\newcommand{\TLSfinishedKey}{\TLSField{finished\_key}}

%%%
%%% Alerts
%%%

\newcommand{\TLSAlert}[1]{\textsf{#1}}

\newcommand{\TLSillegalParameter}{\TLSAlert{illegal\_parameter}}
\newcommand{\TLShandshakeFailure}{\TLSAlert{handshake\_failure}}
\newcommand{\TLSinsufficientSecurity}{\TLSAlert{insufficient\_security}}
\newcommand{\TLSmissingExtension}{\TLSAlert{missing\_extension}}
\newcommand{\TLSunexpectedMessage}{\TLSAlert{unexpected\_message}}
\newcommand{\TLSdecodeError}{\TLSAlert{decode\_error}}
\newcommand{\TLSbadCertificate}{\TLSAlert{bad\_certificate}}
\newcommand{\TLSdecryptError}{\TLSAlert{decrypt\_error}}
\newcommand{\TLScertificateRequired}{\TLSAlert{certificate\_required}}
\newcommand{\TLSunsupportedExtension}{\TLSAlert{unsupported\_extension}}

\newcommand{\TLSrecordOverflow}{\TLSAlert{record\_overflow}}
\newcommand{\TLSbadRecordMac}{\TLSAlert{bad\_record\_mac}}


%%%
%%% HKDF
%%%

\newcommand{\TLSFunction}[1]{\textsf{#1}}

\newcommand{\TranscriptHash}{\TLSFunction{Transcript-Hash}}
\newcommand{\Truncate}{\TLSFunction{Truncate}}
\newcommand{\Hash}{\TLSFunction{Hash}}
%\newcommand{\HMACHash}{\TLSFunction{HMAC-Hash}}
\newcommand{\HMACHash}{\TLSFunction{HMAC}}
\newcommand{\HashLength}{\Hash\TLSFunction{.length}}
\newcommand{\HKDFExpand}{\TLSFunction{HKDF-Expand}}
\newcommand{\HKDFExpandLabel}{\TLSFunction{HKDF-Expand-Label}}
\newcommand{\HKDFExtract}{\TLSFunction{HKDF-Extract}}
\newcommand{\DeriveSecret}{\TLSFunction{Derive-Secret}}
%\newcommand{\ExpandLabel}{\TLSFunction{Expand-Label}}

\newcommand{\AEADEnc}{\TLSFunction{AEAD-Encrypt}}
\newcommand{\AEADDec}{\TLSFunction{AEAD-Decrypt}}

\newcommand{\TLSEarlySecret}{\TLSField{Early Secret}}
\newcommand{\TLSHandshakeSecret}{\TLSField{Handshake Secret}}
\newcommand{\TLSMasterSecret}{\TLSField{Master Secret}}

\newcommand{\TLSAEADEncrypted}{\TLSField{AEADEncrypted}}

\newcommand{\TLSbinderKey}{\TLSField{binder\_key}}
\newcommand{\TLSclientEarlyTrafficSecret}{\TLSField{client\_early\_traffic\_secret}}
\newcommand{\TLSearlyExporterMasterSecret}{\TLSField{early\_exporter\_master\_secret}}
\newcommand{\TLShandshakeTrafficSecret}[1][{[sender]}]{\TLSField{#1\_handshake\_traffic\_secret}}
\newcommand{\TLSclientHandshakeTrafficSecret}{\TLShandshakeTrafficSecret[client]}
\newcommand{\TLSserverHandshakeTrafficSecret}{\TLShandshakeTrafficSecret[server]}
\newcommand{\TLSapplicationTrafficSecret}[2][{[sender]}]{\TLSField{#1\_application\_traffic\_secret\_#2}}
\newcommand{\TLSapplicationTrafficSecretN}[1][N]{\TLSapplicationTrafficSecret{#1}}
\newcommand{\TLSclientApplicationTrafficSecret}[1][0]{\TLSapplicationTrafficSecret[client]{#1}}
\newcommand{\TLSserverApplicationTrafficSecret}[1][0]{\TLSapplicationTrafficSecret[server]{#1}}
\newcommand{\TLSexporterMasterSecret}{\TLSField{exporter\_master\_secret}}
\newcommand{\TLSresumptionMasterSecret}{\TLSField{resumption\_master\_secret}}  
\newcommand{\TLSwriteKey}[1][{[sender]}]{\TLSField{#1\_write\_key}}
\newcommand{\TLSclientWriteKey}{\TLSwriteKey[client]}
\newcommand{\TLSserverWriteKey}{\TLSwriteKey[server]}
\newcommand{\TLSwriteIV}[1][{[sender]}]{\TLSField{#1\_write\_iv}}
\newcommand{\TLSclientWriteIV}{\TLSwriteIV[client]}
\newcommand{\TLSserverWriteIV}{\TLSwriteIV[server]}

\newcommand{\TLSHandshakeMessage}{\textit{Transcript}} 
\newcommand{\TLSContext}{\textit{Context}}  
\newcommand{\TLSHKDFSalt}{\textit{Salt}}
\newcommand{\TLSHKDFSecret}{\textit{Secret}}
\newcommand{\TLSHKDFLabel}{\textit{Label}}
\newcommand{\TLSHKDFLength}{\textit{Length}}

\newcommand{\TLSHKDFExpLabel}{\textit{ExpLabel}}

\newcommand{\TLSHKDFLabelExt}{\textit{HkdfLabel}}


%%%%%%

\newcommand{\zeros}{0\textrm{s}}
